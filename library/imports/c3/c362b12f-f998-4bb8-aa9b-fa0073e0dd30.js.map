{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\game.js"],"names":["cc","Class","extends","Component","properties","scoreDisplay","default","type","Label","starPrefab","Prefab","maxStarDuration","minStarDuration","ground","Node","player","startBtn","onLoad","falsg","score","randomNum","groundY","y","height","spawnNewStar","on","EventType","TOUCH_START","director","loadScene","enabled","setPositionX","newStar","instantiate","starDuration","timer","node","addChild","currntStar","setPosition","getNewStarPosition","getComponent","game","randX","randY","random0To1","jumpHeight","maxX","width","randomMinus1To1","p","start","gameOver","destroy","stopAllActions","update","dt","getNewScore","string","toString"],"mappings":"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","file":"game.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // 文字部分\r\n        scoreDisplay:{\r\n            default:null,\r\n            type:cc.Label\r\n        },\r\n        starPrefab:{\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        // 星星产生后消失时间的随机范围\r\n        maxStarDuration: 0,\r\n        minStarDuration: 0,\r\n        // 地面节点，用于确定星星生成的高度\r\n        ground: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        // player 节点，用于获取主角弹跳的高度，和控制主角行动开关\r\n        player: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        startBtn:{\r\n            default: null,\r\n            type: cc.Node\r\n        }\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.falsg = true;\r\n        this.score = 0;\r\n        this.randomNum = 8;//消失时间\r\n        this.groundY = this.ground.y + this.ground.height / 2;\r\n        this.spawnNewStar();\r\n        this.startBtn.on(cc.Node.EventType.TOUCH_START, () => {\r\n            cc.director.loadScene('game');\r\n            this.player.enabled = true;\r\n        })\r\n        this.startBtn.setPositionX(3000);\r\n    },\r\n    spawnNewStar () {\r\n        var newStar = cc.instantiate(this.starPrefab);\r\n        this.starDuration = this.randomNum;\r\n        this.timer = 0;\r\n        this.node.addChild(newStar);\r\n        this.currntStar = newStar;\r\n        newStar.setPosition(this.getNewStarPosition());\r\n        newStar.getComponent('star').game = this;\r\n    },\r\n    // 随机获得位置\r\n    getNewStarPosition () {\r\n        var randX = 0;\r\n        var randY = this.groundY + cc.random0To1() * this.player.getComponent('Player').jumpHeight + 40;\r\n        var maxX = this.node.width / 2;\r\n        randX = cc.randomMinus1To1() * maxX;\r\n\r\n        return cc.p(randX, randY);\r\n    },\r\n    start () {\r\n        \r\n    },\r\n    gameOver(){\r\n        // 游戏结束\r\n        this.startBtn.setPositionX(0);\r\n        this.player.enabled = false;\r\n        this.falsg = false;\r\n        this.player.destroy();\r\n        this.currntStar.destroy();\r\n        this.player.stopAllActions();//停止动画\r\n        // cc.director.loadScene('game');\r\n    },\r\n    update (dt) {\r\n        if(!this.falsg){return}\r\n        if (this.timer > this.starDuration) {\r\n            this.gameOver();\r\n            return;\r\n        }\r\n        this.timer += dt;\r\n    },\r\n    getNewScore(){\r\n        this.score += 1;\r\n        this.scoreDisplay.string = 'score : ' + this.score.toString();\r\n    }\r\n});\r\n"]}